webpackJsonp([5],{121:function(t,e,i){"use strict";function a(t){i(279)}Object.defineProperty(e,"__esModule",{value:!0});var n=i(285),o=i(286),r=i(1),c=a,s=r(n.a,o.a,!1,c,null,null);e.default=s.exports},126:function(t,e,i){t.exports=i.p+"img/icon_yizhu@2x.png?5517edf19dc71a40f55323ec201dfcfe"},129:function(t,e){t.exports=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";if(!t)return"";"string"==typeof t&&(t=new Date(t.replace(/-/g,"/"))),"number"==typeof t&&(t=new Date(t));var i={"M+":t.getMonth()+1,"D+":t.getDate(),"h+":t.getHours()%12==0?12:t.getHours()%12,"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()},a={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};/(Y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+a[t.getDay()+""]));for(var n in i)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return e}},148:function(t,e,i){t.exports=i.p+"img/portrait@2x.png?78b6703403712c5f96f041d488e3f319"},176:function(t,e,i){t.exports=i.p+"img/loading.gif?ab5dccb6ad64570e49336400a399cef0"},279:function(t,e,i){var a=i(280);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(3)("66f9993c",a,!0)},280:function(t,e,i){e=t.exports=i(2)(void 0),e.push([t.i,'#chat{font-size:0;transition:opacity .2s ease;min-height:100%;background-color:#f6f6f6}#chat .blank-block{height:.5rem}#chat input:focus{outline:none;-webkit-appearance:none}#chat .chat-text-box{background:#f6f6f6;padding:.12rem}#chat .chat-text-box .tips{font-size:.14rem;color:#999;background:#ebebeb;text-align:center;padding:.1rem}#chat .chat-text-box .tips a{color:#00a560}#chat .text-area-item{font-size:.14rem;color:#fff;overflow:hidden;margin-bottom:.1rem;background-color:#f6f6f6}#chat .text-area-item .time{font-size:.12rem;color:#ccc;text-align:center;width:2.1rem;margin:.1rem auto;border-radius:.04rem;padding:.02rem 0}#chat .text-area-item .inner .content{max-width:2.6rem;min-width:.4rem;min-height:.4rem;margin:0 .1rem;border-radius:.04rem;padding:.1rem;box-sizing:border-box;word-break:break-all;text-align:justify;font-size:.16rem;color:#333}#chat .text-area-item.left .content{background-color:#fff;position:relative}#chat .text-area-item.left .content:before{content:"";display:inline-block;position:absolute;width:0;height:0;background-color:transparent;border:.08rem solid #fff;top:.12rem;border-left-color:transparent;border-top-color:transparent;border-bottom-color:transparent;left:-.14rem}#chat .text-area-item.right .content{background-color:#b0f5bf;position:relative}#chat .text-area-item.right .content:after{content:"";display:inline-block;position:absolute;width:0;height:0;background-color:transparent;border:.08rem solid #b0f5bf;right:-.14rem;top:.12rem;border-right-color:transparent;border-top-color:transparent;border-bottom-color:transparent}#chat .text-area-item .inner .avatar{width:.4rem;height:.4rem;border-radius:50%}#chat .text-area-item .doc-name{color:#666;padding-left:.1rem;font-size:.12rem}#chat .text-area-item.left .avatar,#chat .text-area-item.left .content{float:left}#chat .text-area-item .content button{display:inline-block;width:.16rem;height:.16rem;background-size:100% 100%;background-color:transparent;border:none;outline:none}#chat .text-area-item.left .content button{background-image:url('+i(281)+")}#chat .text-area-item.left .content button.change{background-image:url("+i(282)+")}#chat .text-area-item.right .content button{background-image:url("+i(283)+")}#chat .text-area-item.right .content button.change{background-image:url("+i(284)+")}#chat .text-area-item.right .content .duration{left:-.3rem}#chat .text-area-item.left .content .duration,#chat .text-area-item.right .content .duration{position:absolute;display:inline-block;width:.3rem;height:.3rem;top:.04rem;color:#999;font-size:.12rem;text-align:center;line-height:.3rem}#chat .text-area-item.left .content .duration{left:.5rem}#chat .text-area-item.left .box{float:left}#chat .text-area-item.right .avatar,#chat .text-area-item.right .box,#chat .text-area-item.right .content{float:right}#chat .text-area-item.left .content .card-box{border:2px solid #00a560;padding:.1rem;border-radius:4px;width:2rem;overflow:hidden}#chat .text-area-item.left .content .card-box .card-title{padding-bottom:.03rem;border-bottom:1px dashed #e9e9e9;text-align:right;font-size:.14rem;color:#999}#chat .text-area-item.left .content .card-box .card-info{overflow:hidden;width:100%;margin-top:.05rem;font-size:0}#chat .text-area-item.left .content .card-box .card-info img{width:.36rem;height:.36rem;border-radius:.36rem;float:left;margin-right:.05rem}#chat .text-area-item.left .content .card-box .card-info .info{float:right;overflow:hidden;width:calc(100% - .41rem)}#chat .text-area-item.left .content .card-box .card-info .info p{word-break:normal;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}#chat .text-area-item.left .content .card-box .card-info .info p:first-child{font-size:.12rem;color:#999}#chat .text-area-item.left .content .card-box .card-info .info p:first-child span{color:#333;font-size:.14rem}#chat .text-area-item.left .content .card-box .card-info .info p:last-child{font-size:.14rem;color:#7dcbff}#chat .input-box{position:fixed;width:100%;left:0;bottom:0;height:.5rem;background:#f4f4f6;line-height:.5rem;border-top:1px solid #e9e9e9;box-shadow:0 -1px 0 0 #f4f4f6;-webkit-touch-callout:none;-moz-touch-callout:none;-ms-touch-callout:none;touch-callout:none}#chat .input-box .record{padding:0 .1rem;display:inline-block}#chat .record img{width:.25rem;vertical-align:middle}#chat .input-box div .plus{width:.3rem;height:.3rem;vertical-align:middle}#chat .input-box input{border:none;padding:0 .1rem;width:2.55rem;margin-left:.2rem}#chat .input-box button,#chat .input-box input{height:.4rem;vertical-align:middle;font-size:.14rem}#chat .input-box button{border:1px solid #e9e9e9;border-radius:5px;width:2.75rem;outline:none;background-color:transparent}#chat .input-box button.active{background-color:#dfdfdf}#chat .input-box .upload-img{padding-left:.1rem;display:inline-block}#chat .input-box .upload-img div{font-size:12px;display:inline-block;vertical-align:middle;color:#fff;height:.3rem;width:.4rem;background-color:#00a560;text-align:center;line-height:.3rem;border-radius:3px}#chat .input-box .no-click{position:absolute;width:100%;height:100%;background-color:transparent;top:0;left:0}#chat .record-modal{background:rgba(0,0,0,.4);width:100%;height:100%;left:0;top:0;position:fixed;z-index:12;display:none}#chat .record-modal.show{display:block}#chat .record-modal .content{width:1rem;height:1rem;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;background:#fff;width:2rem;height:2rem}#chat .loading-modal{position:fixed;width:100%;height:100%;left:0;top:0;background-color:rgba(1,1,1,.1);text-align:center}#chat .loading-modal img{display:inline-block;width:1rem;height:1rem;position:absolute;margin-top:-.5rem;top:50%;margin-left:-.5rem;left:50%}#chat .preview-img{position:fixed;width:100%;height:100%;left:0;top:0;background-color:rgba(1,1,1,.2);z-index:1000;text-align:center;vertical-align:middle}#chat .preview-img img{vertical-align:middle;width:80%}#chat .preview-img span{display:inline-block;height:100%;vertical-align:middle}",""])},281:function(t,e,i){t.exports=i.p+"img/static-left.jpg?88f825891cdadbedb590581f5b9d8cb9"},282:function(t,e,i){t.exports=i.p+"img/loading-left.gif?15150bde510b2a4aa5cfd47dcb5a3657"},283:function(t,e,i){t.exports=i.p+"img/static-right.jpg?10b908cd3e9f484a1839983bc026de35"},284:function(t,e,i){t.exports=i.p+"img/loading-right.gif?fbb643771c6c5524150b257d604c6c69"},285:function(t,e,i){"use strict";(function(t){var a=i(8),n=i(129),o=(i.n(n),i(21)),r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t};e.a={data:function(){return{myhead:"",chatList:[],inputText:"",servicedetailid:this.$route.params.servicedetailid,msg:{},defaultImg:'this.src="'+i(126)+'"',defaultmyImg:'this.src="'+i(148)+'"',BASEIMGURL:a.a.BASEIMGURL,send:!1,cansend:!0,setint:"",timerId:null,preimg:"",showpreimg:!1}},created:function(){2==this.$route.params.status&&(this.cansend=!1)},computed:r({},Object(o.b)({token:function(t){return t.token}})),watch:{token:function(){var t=this;this.$store.state.phone&&this.$store.state.token&&(t.msgApi(),t.setint=setInterval(function(){t.msgApi()},5e4))},chatList:function(){this.$nextTick(function(){setTimeout(function(){t(".text-area-item").last().length&&t(".text-area-item").last().get(0).scrollIntoView()},400)})},inputText:function(){this.inputText.length>0?this.send=!0:this.send=!1}},methods:{sendmessage:function(e){var i=this;if(t(e.currentTarget).blur(),!this.inputText.trim())return this.$vux.toast.text("发送信息不能为空","top"),!1;var n={createDate:(new Date).getTime(),url:this.myhead,content:this.inputText,secondType:"4001",load:!0};this.chatList.push(n);var o={oi:i.servicedetailid,msgType:"txt",content:i.inputText};i.inputText="",a.a.sendmsg(o).then(function(t){"000"==t.code&&(i.chatList[i.chatList.length-1].load=!1)})},uploadimg:function(){t("#upLoad").click()},upchange:function(t){var e=this,n=new FormData;n.append("content",t.target.files[0]),n.append("METHOD","uploadimage"),n.append("RECDATA",JSON.stringify({code:"chat"}));var o={createDate:(new Date).getTime(),url:this.myhead,content:i(176),secondType:"4003"};e.chatList.push(o),a.a.uploadimg(n,function(t){if("000"===t.code){var i=JSON.parse(t.data),n=i.urls[0],o=i.pname[0],r={oi:e.servicedetailid,msgType:"img",content:o};a.a.sendmsg(r).then(function(t){"000"===t.code&&(e.chatList[e.chatList.length-1].content=n)})}})},playMp3:function(e){var i=t(e.currentTarget),a=t(e.currentTarget).next()[0];a.play(),i.addClass("change"),a.onended=function(){i.removeClass("change")}},preview:function(t){this.preimg=t,this.showpreimg=!0},hideview:function(){this.preimg="",this.showpreimg=!1},goclinic:function(t){location.href="#/clinic/"+t},msgApi:function(){var t=this,e=this;a.a.getmsg({oi:e.servicedetailid}).then(function(i){if("000"==i.code){JSON.parse(i.data).status>3&&(e.$vux.alert.show({content:"您的会话已结束！"}),e.cansend=!1,clearInterval(t.setint)),e.msg=JSON.parse(i.data),console.log(JSON.parse(i.data));var n=e.msg.list;n.sort(function(t,e){return t.createDate-e.createDate}),e.chatList=n,a.a.getuserinfo({}).then(function(t){if("000"===t.code){var i=JSON.parse(t.data);e.myhead=i.userHead}})}else if("10007"===i.code){var o=t.$route.fullPath.substring(1,t.$route.fullPath.length);return location.href="#/login/"+encodeURIComponent(o),!1}})},inputFocu:function(){console.log(t(".text-area-item").last().get(0)),setTimeout(function(){t(".text-area-item").last().length&&t(".text-area-item").last().get(0).scrollIntoView()},400)}},mounted:function(){var e=this;t(window).height();t(window).resize(function(){t(window).height(),t(window).height()}),this.$nextTick(function(){setTimeout(function(){t(".text-area-item").last().length&&t(".text-area-item").last().get(0).scrollIntoView()},400)}),this.$store.state.phone&&this.$store.state.token&&(e.msgApi(),e.setint=setInterval(function(){e.msgApi()},5e4))},beforeDestroy:function(){clearInterval(this.setint)}}}).call(e,i(10))},286:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"chat"}},[a("div",{staticClass:"chat-text-box"},[t._m(0),t._v(" "),a("div",{staticClass:"text-area-list"},t._l(t.chatList,function(e,n){return a("div",{staticClass:"text-area-item",class:{left:e.pusherId==t.msg.doctorUserId.toString(),right:e.pusherId!==t.msg.doctorUserId.toString()}},[a("p",{staticClass:"time"},[t._v(t._s(t._f("time")(e.createDate)))]),t._v(" "),a("div",{staticClass:"inner"},[e.pusherId==t.msg.doctorUserId.toString()?a("img",{staticClass:"avatar",attrs:{src:t.BASEIMGURL+e.headUrl,alt:"",onerror:t.defaultImg}}):t._e(),t._v(" "),e.pusherId!=t.msg.doctorUserId.toString()?a("img",{staticClass:"avatar",attrs:{src:t.myhead,alt:"",onerror:t.defaultmyImg}}):t._e(),t._v(" "),a("div",{staticClass:"box"},[a("p",{directives:[{name:"show",rawName:"v-show",value:e.pusherId==t.msg.doctorUserId.toString(),expression:"(one.pusherId == msg.doctorUserId.toString())"}],staticClass:"doc-name"},[t._v(t._s(e.pusherName))]),t._v(" "),"4001"===e.secondType?a("div",{staticClass:"content"},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.load,expression:"one.load"}],staticStyle:{position:"absolute",width:".3rem",left:"-.3rem",top:"0.04rem"},attrs:{src:i(176)}}),t._v("\n              "+t._s(e.content)+"\n            ")]):t._e(),t._v(" "),"4005"===e.secondType?a("div",{staticClass:"content"},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.load,expression:"one.load"}],staticStyle:{position:"absolute",width:".3rem",left:"-.3rem",top:"0.04rem"},attrs:{src:i(176)}}),t._v(" "),a("span",[t._v("[视频，请到乐乐医APP上查看]")])]):t._e(),t._v(" "),"4003"===e.secondType?a("div",{staticClass:"content"},[a("img",{staticStyle:{width:"1rem"},attrs:{src:e.content,alt:"error"},on:{click:function(i){t.preview(e.content)}}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showpreimg,expression:"showpreimg"}],staticClass:"preview-img",on:{click:function(e){t.hideview()}}},[a("img",{attrs:{src:t.preimg}}),t._v(" "),a("span")])]):t._e(),t._v(" "),"4002"===e.secondType?a("div",{staticClass:"content"},[a("span",{staticClass:"duration"},[t._v(t._s(e.duration))]),t._v(" "),a("button",{on:{click:function(e){t.playMp3(e)}}}),t._v(" "),a("audio",{attrs:{src:e.content}})]):t._e(),t._v(" "),"4007"===e.secondType?a("div",{staticClass:"content"},[a("div",{staticClass:"card-box",on:{click:function(i){t.goclinic(JSON.parse(e.content).r)}}},[a("p",{staticClass:"card-title"},[t._v("名片")]),t._v(" "),a("div",{staticClass:"card-info"},[a("img",{attrs:{src:t.BASEIMGURL+JSON.parse(e.content).u}}),t._v(" "),a("div",{staticClass:"info"},[a("p",[a("span",[t._v(t._s(JSON.parse(e.content).n))]),t._v(" "+t._s(JSON.parse(e.content).h))]),t._v(" "),a("p",[t._v(t._s(JSON.parse(e.content).o1)+" "+t._s(JSON.parse(e.content).o2))])])])])]):t._e()])])])}))]),t._v(" "),a("div",{staticClass:"blank-block"}),t._v(" "),t.cansend?a("div",{staticClass:"input-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],attrs:{type:"text",maxlength:"1000"},domProps:{value:t.inputText},on:{focus:t.inputFocu,input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),t._v(" "),a("div",{staticClass:"upload-img"},[a("svg",{directives:[{name:"show",rawName:"v-show",value:!t.send,expression:"!send"}],staticClass:"vux-x-icon vux-x-icon-ios-plus-outline plus",attrs:{type:"ios-plus-outline",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 512 512"},on:{click:t.uploadimg}},[a("path",{attrs:{d:"M256 48C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48zm0 398.7c-105.1 0-190.7-85.5-190.7-190.7S150.9 65.3 256 65.3 446.7 150.9 446.7 256 361.1 446.7 256 446.7z"}}),a("path",{attrs:{d:"M264.1 128h-16.8v119.9H128v16.8h119.3V384h16.8V264.7H384v-16.8H264.1z"}})]),t._v(" "),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"upLoad",accept:"image/*"},on:{change:function(e){t.upchange(e)}}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.send,expression:"send"}],on:{click:t.sendmessage}},[t._v("发送")])])]):t._e()])},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("p",{staticClass:"tips"},[t._v("请描述病情，等待医生回复。"),i("br"),t._v("客服电话"),i("a",{attrs:{href:"tel:4001816106"}},[t._v("400-181-6106")])])}],o={render:a,staticRenderFns:n};e.a=o}});
//# sourceMappingURL=5.js.map?891f3dc194c07691be54